{"componentChunkName":"component---src-templates-content-template-js","path":"/osa3/sovellus_internetiin","result":{"data":{"markdownRemark":{"html":"<div class=\"content\">\n<p>Yhdistetään seuraavaksi <a href=\"/osa2\">osassa 2</a> tekemämme frontend omaan backendiimme. </p>\n<p>Edellisessä osassa backendinä toiminut JSON Server tarjosi muistiinpanojen listan osoitteessa <a href=\"http://localhost:3001/notes\">http://localhost:3001/notes</a> frontendin käyttöön. Backendimme urlien rakenne on hieman erilainen (muistiinpanot ovat osoitteessa <a href=\"http://localhost:3001/api/notes\">http://localhost:3001/api/notes</a>) eli muutetaan frontendin tiedostossa <i>src/services/notes.js</i> määriteltyä muuttujaa <em>baseUrl</em> seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> baseUrl <span class=\"token operator\">=</span> <span class=\"token string\">'http://localhost:3001/api/notes'</span></span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getAll</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> request <span class=\"token operator\">=</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>baseUrl<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span> getAll<span class=\"token punctuation\">,</span> create<span class=\"token punctuation\">,</span> update <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Frontendin tekemä GET-pyyntö osoitteeseen <a href=\"http://localhost:3001/api/notes\">http://localhost:3001/api/notes</a> ei jostain syystä toimi:</p>\n<picture><img src=\"/static/da88e17cb078c89a6e7ba30d61fab0e6/5a190/3ae.png\" alt=\"Konsolissa näkyy virhe &#x27;Access ... blocked by CORS policy&#x27;\" srcset=\"/static/da88e17cb078c89a6e7ba30d61fab0e6/772e8/3ae.png 200w,\n/static/da88e17cb078c89a6e7ba30d61fab0e6/e17e5/3ae.png 400w,\n/static/da88e17cb078c89a6e7ba30d61fab0e6/5a190/3ae.png 800w,\n/static/da88e17cb078c89a6e7ba30d61fab0e6/c1b63/3ae.png 1200w,\n/static/da88e17cb078c89a6e7ba30d61fab0e6/29007/3ae.png 1600w,\n/static/da88e17cb078c89a6e7ba30d61fab0e6/6e29b/3ae.png 1610w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Mistä on kyse? Backend toimii kuitenkin selaimesta ja postmanista käytettäessä ilman ongelmaa.</p>\n<h3>Same origin policy ja CORS</h3>\n<p>Kyse on asiasta nimeltään CORS eli Cross-origin resource sharing. <a href=\"https://en.wikipedia.org/wiki/Cross-origin_resource_sharing\">Wikipedian</a> sanoin</p>\n<blockquote>\n<p><i>Cross-origin resource sharing (CORS) is a mechanism that allows restricted resources (e.g. fonts) on a web page to be requested from another domain outside the domain from which the first resource was served. A web page may freely embed cross-origin images, stylesheets, scripts, iframes, and videos. Certain \"cross-domain\" requests, notably Ajax requests, are forbidden by default by the same-origin security policy.</i></p>\n</blockquote>\n<p>Lyhyesti sanottuna meidän kontekstissa kyse on seuraavasta: web-sovelluksen selaimessa suoritettava JavaScript-koodi saa oletusarvoisesti kommunikoida vain samassa <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">originissa</a> olevan palvelimen kanssa. Koska palvelin on localhostin portissa 3001 ja frontend localhostin portissa 5173, niiden origin ei ole sama.</p>\n<p>Korostetaan vielä, että <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">same origin policy</a> ja CORS eivät ole mitenkään React- tai Node-spesifisiä asioita, vaan yleismaailmallisia periaatteita web-sovellusten toiminnasta.</p>\n<p>Voimme sallia muista <i>origineista</i> tulevat pyynnöt käyttämällä Noden <a href=\"https://github.com/expressjs/cors\">cors</a>-middlewarea.</p>\n<p>Asennetaan backendiin <i>cors</i> komennolla</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> cors</code></pre></div>\n<p>Otetaan middleware käyttöön toistaiseksi sellaisella konfiguraatiolla, joka sallii kaikista origineista tulevat pyynnöt kaikkiin backendin Express routeihin:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> cors <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cors'</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token function\">cors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Nyt frontend toimii muuten, mutta muistiinpanojen tärkeäksi muuttaminen ei vielä onnistu, sillä toiminnallisuutta backendissa ei vielä ole.</p>\n<p>CORS:ista voi lukea tarkemmin esim. <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">Mozillan sivuilta</a>.</p>\n<p>Sovelluksen suoritusympäristö näyttää nyt seuraavalta:</p>\n<picture><img src=\"/static/20b558375e438a856a0520e775f93239/37523/100_25.png\" alt=\"Kuvassa localhost:5173 toimiva Vite dev server ja localhost:3001 toimiva node backend, jotka molemmat käyttävät lokaalilla levylä olevia fs-tiedostoja. Kuvassa myös selaimessa oleva react-sovellus. joka yhteydessä dev-serveriin (mistä se saa js-tiedoston) sekä node-backendiin jonka reitilt /app/notes sen saa json-muotoisen datan\" srcset=\"/static/20b558375e438a856a0520e775f93239/772e8/100_25.png 200w,\n/static/20b558375e438a856a0520e775f93239/e17e5/100_25.png 400w,\n/static/20b558375e438a856a0520e775f93239/37523/100_25.png 720w\" sizes=\"(max-width: 720px) 100vw, 720px\"></picture>\n<p>Selaimessa toimiva frontendin koodi siis hakee datan osoitteessa localhost:3001 olevalta Express-palvelimelta.</p>\n<h3>Sovellus Internetiin</h3>\n<p>Kun koko \"stäkki\" on saatu vihdoin kuntoon, siirretään sovellus Internetiin.</p>\n<p>Sovellusten hostaamiseen, eli \"internettiin laittamiseen\" on olemassa lukematon määrä erilaisia ratkaisuja. Helpoimpia näistä sovelluskehittäjän kannalta ovat ns PaaS (eli Platform as a Service) ‑palvelut, jotka huolehtivat sovelluskehittäjän puolesta tietokannan ja suoritusympäristön asentamisen.</p>\n<p>Kymmenen vuoden ajan PaaS-ratkaisujen ykkönen on ollut <a href=\"http://heroku.com\">Heroku</a>. Elokuun 2022 lopussa Heroku ilmoitti että 27.11.2022 alkaen alustan maksuttomat palvelut loppuvat. Jos olet valmis maksamaan hiukan, on Heroku edelleen varteenotettava vaihtoehto.</p>\n<p>Esittelemme seuraavassa kaksi hieman uudempaa palvelua <a href=\"https://fly.io/\">Fly.io:n</a>:n sekä <a href=\"https://render.com/\">Renderin</a>. Fly.io tarjoaa palveluna enemmän joustavuutta, mutta myös se on muuttunut hiljattain maksulliseksi. Renderissä on tarjolla jonkin verran ilmaista laskenta-aikaa, joten jos haluat suorittaa kurssin ilman kuluja, valitse Render. Renderin käyttöönotto saattaa myös olla jossain tapauksissa helpompaa, sillä Render ei edellytä mitään asennuksia omalle koneelle.</p>\n<p>On olemassa myös muita palveluja, jotka saattavat toimia hyvin tämän kurssin kanssa, ainakin kaikissa muissa osissa paitsi osassa 11 (CI/CD), jossa saattaa olla yksi hankala harjoitus muille alustoille.</p>\n<p>Jotkut kurssin osallistujat ovat käyttäneet seuraavia palveluita:</p>\n<ul>\n<li><a href=\"https://replit.com\">Replit</a></li>\n<li><a href=\"https://codesandbox.io\">CodeSandBox</a></li>\n</ul>\n<p>Jos tiedät helppokäyttöisiä ja ilmaisia palveluita NodeJS:n hostaamiseen, kerro siitä meille!</p>\n<p>Molempia ratkaisuja varten muutetaan tiedoston <i>index.js</i> lopussa olevaa sovelluksen käyttämän portin määrittelyä seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PORT</span> <span class=\"token operator\">||</span> <span class=\"token number\">3001</span></span>app<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Server running on port </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PORT</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Nyt käyttöön tulee <a href=\"https://en.wikipedia.org/wiki/Environment_variable\">ympäristömuuttujassa</a> <em>PORT</em> määritelty portti tai 3001, jos ympäristömuuttuja <em>PORT</em> ei ole määritelty. Sekä Fly.io:ssa että Renderissä sovelluksen portti on mahdollista konfiguroida ympäristömuuttujan avulla.</p>\n<h4>Fly.io</h4>\n<p><i>Huomaa, että sinun tulee mahdollisesti syöttää Fly.io:hon maksukorttisi numero, ja palvelun käytöstä veloitetaan hinnaston mukaisesti, jos erillistä ilmaista kokeilua ei ole tarjolla.</i></p>\n<p>Jos päätät käyttää <a href=\"https://fly.io/\">Fly.io</a>:ta, aloita asentamalla Fly.io <a href=\"https://fly.io/docs/hands-on/install-flyctl/\">tämän</a> ohjeen mukaan ja luomalla itsellesi <a href=\"https://fly.io/docs/hands-on/sign-up/\">tunnus</a> palveluun.</p>\n<p>Aloita <a href=\"https://fly.io/docs/hands-on/sign-in/\">kirjautumalla</a> komentoriviltä palveluun komennolla </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">fly auth login</code></pre></div>\n<p><em>HUOM</em> jos komento fly ei toimi, kokeile toimiiko sen pidempi muoto <em>flyctl</em>. Esim. Macissa toimivat komennon molemmat muodot.</p>\n<p>Sovelluksen alustus tapahtuu seuraavasti. Mene sovelluksen juurihakemistoon ja anna komento</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">fly launch --no-deploy</code></pre></div>\n<p>Anna sovellukselle nimi, tai anna Fly.io:n generoida automaattinen nimi, valitse \"region\" eli alue, jonka konesalissa sovelluksesi toimii. Älä luo sovellukselle postgres- sekä Upstash Redis-tietokantaa. Lopuksi vielä kysytään \"Would you like to deploy now?\" eli haluatko että sovellus myös viedään tuotantoympäristöön. Valitse \"Ei\".</p>\n<p>Fly.io luo hakemistoosi tiedoston <i>fly.toml</i>, joka sisältää sovelluksen tuotantoympäristön konfiguraation.</p>\n<p>Jotta sovellus saadaan konfiguroitua oikein, tulee tiedostoon konfiguraatioon tehdä pieni lisäys osiin [env]</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>build<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span>env<span class=\"token punctuation\">]</span>\n  PORT <span class=\"token operator\">=</span> <span class=\"token string\">\"3001\"</span> <span class=\"token comment\"># add this</span>\n\n<span class=\"token punctuation\">[</span>http_service<span class=\"token punctuation\">]</span>\n  internal_port <span class=\"token operator\">=</span> <span class=\"token number\">3001</span> <span class=\"token comment\"># ensure that this is same as PORT</span>\n  force_https <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n  auto_stop_machines <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n  auto_start_machines <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n  min_machines_running <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n  processes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"app\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Osaan [env] lisätään tarvittaessa (jos se ei jo siellä valmiiksi ole) määritelmä ympäristömuuttujalle PORT, jotta sovellus osaa käynnistää itsensä samaan samaan porttiin, missä Fly olettaa (määrittely kohdassa [services]) sen olevan käynnissä.</p>\n<p>Sovellus voidaan nyt käynnistää komennolla</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">fly deploy</code></pre></div>\n<p>Jos kaikki menee hyvin, sovellus käynnistyy ja saat sen avattua selaimeen komennolla </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">fly apps <span class=\"token function\">open</span></code></pre></div>\n<p>Tämän jälkeen aina kun teet muutoksia sovellukseen, saat vietyä uuden version tuotantoon komennolla </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">fly deploy</code></pre></div>\n<p>Erittäin tärkeä komento on myös <em>fly logs</em> jonka avulla voit seurata tuotantopalvelimen konsoliin tulostuvia logeja. Logit on viisainta pitää koko ajan näkyvillä.</p>\n<h4>Render</h4>\n<p>Huomaa, että saatat joutua syöttämään pankkikorttisi tiedot palveluun, vaikka käyttäisit vain ilmaisia ominaisuuksia. Ohje olettaa, että Renderiin on <a href=\"https://dashboard.render.com/\">kirjauduttu</a> GitHub-tunnuksen avulla.</p>\n<p>Kirjautumisen jälkeen luodaan uusi \"web service\":</p>\n<picture><img src=\"/static/918351e5ad479c327ac578c0743a0811/5a190/r1.png\" srcset=\"/static/918351e5ad479c327ac578c0743a0811/772e8/r1.png 200w,\n/static/918351e5ad479c327ac578c0743a0811/e17e5/r1.png 400w,\n/static/918351e5ad479c327ac578c0743a0811/5a190/r1.png 800w,\n/static/918351e5ad479c327ac578c0743a0811/c1b63/r1.png 1200w,\n/static/918351e5ad479c327ac578c0743a0811/29007/r1.png 1600w,\n/static/918351e5ad479c327ac578c0743a0811/5ab15/r1.png 2446w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Yhdistetään sovelluksen repositorio Renderiin:</p>\n<picture><img src=\"/static/75040aae9bcb08b7aa53fd201ed900a9/5a190/r2.png\" srcset=\"/static/75040aae9bcb08b7aa53fd201ed900a9/772e8/r2.png 200w,\n/static/75040aae9bcb08b7aa53fd201ed900a9/e17e5/r2.png 400w,\n/static/75040aae9bcb08b7aa53fd201ed900a9/5a190/r2.png 800w,\n/static/75040aae9bcb08b7aa53fd201ed900a9/c1b63/r2.png 1200w,\n/static/75040aae9bcb08b7aa53fd201ed900a9/29007/r2.png 1600w,\n/static/75040aae9bcb08b7aa53fd201ed900a9/966c1/r2.png 1694w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Yhdistäminen onnistuu ainakin jos repositorio on julkinen.</p>\n<p>Määritellään sovelluksen tiedot. Jos sovellus <i>ei ole</i> repositorion juuressa, tulee oikea hakemisto määritellä kohtaan <i>Root directory</i>:</p>\n<picture><img src=\"/static/8411e07f2b7ee2665f61341b7253e49f/5a190/r3.png\" srcset=\"/static/8411e07f2b7ee2665f61341b7253e49f/772e8/r3.png 200w,\n/static/8411e07f2b7ee2665f61341b7253e49f/e17e5/r3.png 400w,\n/static/8411e07f2b7ee2665f61341b7253e49f/5a190/r3.png 800w,\n/static/8411e07f2b7ee2665f61341b7253e49f/c1b63/r3.png 1200w,\n/static/8411e07f2b7ee2665f61341b7253e49f/29007/r3.png 1600w,\n/static/8411e07f2b7ee2665f61341b7253e49f/97a96/r3.png 2400w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Tämän jälkeen sovellus käynnistyy Renderiin. Sovelluksen sivu kertoo sovelluksen tilan ja osoitteen, mihin sovellus on käynnistynyt:</p>\n<picture><img src=\"/static/4a478e6ef9229324ff606f2ada7b0b46/5a190/r4.png\" srcset=\"/static/4a478e6ef9229324ff606f2ada7b0b46/772e8/r4.png 200w,\n/static/4a478e6ef9229324ff606f2ada7b0b46/e17e5/r4.png 400w,\n/static/4a478e6ef9229324ff606f2ada7b0b46/5a190/r4.png 800w,\n/static/4a478e6ef9229324ff606f2ada7b0b46/c1b63/r4.png 1200w,\n/static/4a478e6ef9229324ff606f2ada7b0b46/29007/r4.png 1600w,\n/static/4a478e6ef9229324ff606f2ada7b0b46/60ab9/r4.png 2450w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Oletusarvoisella konfiguraatiolla sovelluksen pitäisi <a href=\"https://render.com/docs/deploys\">uudelleenkäynnistyä</a> jokaisen GitHubiin pushatun commitin myötä automaattisesti uudelleen. Jostain syystä tämä ei kuitenkaan toimi aina.</p>\n<p>Sovelluksen saa myös uudelleenkäynnistettyä manuaalisesti:</p>\n<picture><img src=\"/static/b87d1b6ab7339294ad1f00453155e733/5a190/r5.png\" srcset=\"/static/b87d1b6ab7339294ad1f00453155e733/772e8/r5.png 200w,\n/static/b87d1b6ab7339294ad1f00453155e733/e17e5/r5.png 400w,\n/static/b87d1b6ab7339294ad1f00453155e733/5a190/r5.png 800w,\n/static/b87d1b6ab7339294ad1f00453155e733/c1b63/r5.png 1200w,\n/static/b87d1b6ab7339294ad1f00453155e733/29007/r5.png 1600w,\n/static/b87d1b6ab7339294ad1f00453155e733/79538/r5.png 2530w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Dashboardin kautta on myös mahdollista seurata sovelluksen lokia:</p>\n<picture><img src=\"/static/798d2488fb450327abf2b6729faaaeec/5a190/r7.png\" srcset=\"/static/798d2488fb450327abf2b6729faaaeec/772e8/r7.png 200w,\n/static/798d2488fb450327abf2b6729faaaeec/e17e5/r7.png 400w,\n/static/798d2488fb450327abf2b6729faaaeec/5a190/r7.png 800w,\n/static/798d2488fb450327abf2b6729faaaeec/c1b63/r7.png 1200w,\n/static/798d2488fb450327abf2b6729faaaeec/29007/r7.png 1600w,\n/static/798d2488fb450327abf2b6729faaaeec/b5c8e/r7.png 2194w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Huomaamme nyt lokista, että sovellus on käynnistynyt porttiin 10000. Sovellus saa käynnistysportin ympäristömuuttujan PORT kautta, eli on äärimmäisen tärkeää että tiedoston <i>index.js</i> loppu on päivitetty muotoon:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PORT</span> <span class=\"token operator\">||</span> <span class=\"token number\">3001</span></span>app<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Server running on port </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PORT</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Frontendin tuotantoversio</h3>\n<p>Olemme toistaiseksi suorittaneet React-koodia <i>sovelluskehitysmoodissa</i>, jossa sovellus on konfiguroitu antamaan havainnollisia virheilmoituksia, päivittämään koodiin tehdyt muutokset automaattisesti selaimeen ym.</p>\n<p>Kun sovellus viedään tuotantoon, täytyy siitä tehdä <a href=\"https://vitejs.dev/guide/build.html\">production build</a> eli tuotantoa varten optimoitu versio.</p>\n<p>Viten avulla tehdyistä sovelluksista saadaan tehtyä tuotantoversio komennolla <a href=\"https://vitejs.dev/guide/build.html\"><em>npm run build</em></a>.</p>\n<p>Suoritetaan nyt komento <i>frontendin projektin juuressa</i>.</p>\n<p>Komennon seurauksena syntyy hakemiston <i>dist</i> (joka sisältää jo sovelluksen ainoan html-tiedoston <i>index.html</i>) sisään hakemisto <i>assets</i>, jonka alle generoituu sovelluksen JavaScript-koodin <a href=\"https://en.wikipedia.org/wiki/Minification_(programming)\">minifioitu</a> versio. Vaikka sovelluksen koodi on kirjoitettu useaan tiedostoon, generoituu kaikki JavaScript yhteen tiedostoon. Samaan tiedostoon tulee  myös kaikkien sovelluksen koodin tarvitsemien riippuvuuksien koodi.</p>\n<p>Minifioitu koodi ei ole miellyttävää luettavaa. Koodin alku näyttää seuraavalta:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">!</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">function</span> <span class=\"token function\">r</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> n<span class=\"token punctuation\">,</span>f<span class=\"token punctuation\">,</span>i<span class=\"token operator\">=</span>r<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>l<span class=\"token operator\">=</span>r<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>a<span class=\"token operator\">=</span>r<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>c<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>s<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>c<span class=\"token operator\">&lt;</span>i<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>c<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>f<span class=\"token operator\">=</span>i<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>o<span class=\"token punctuation\">[</span>f<span class=\"token punctuation\">]</span><span class=\"token operator\">&amp;&amp;</span>s<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">[</span>f<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>o<span class=\"token punctuation\">[</span>f<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>n <span class=\"token keyword\">in</span> l<span class=\"token punctuation\">)</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>l<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">p</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>s<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span>s<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">return</span> u<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span>u<span class=\"token punctuation\">,</span>a<span class=\"token operator\">||</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token keyword\">function</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> e<span class=\"token punctuation\">,</span>r<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>r<span class=\"token operator\">&lt;</span>u<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>r<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> t<span class=\"token operator\">=</span>u<span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>n<span class=\"token operator\">=</span><span class=\"token operator\">!</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>i<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>t<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">var</span> l<span class=\"token operator\">=</span>t<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token number\">0</span><span class=\"token operator\">!==</span>o<span class=\"token punctuation\">[</span>l<span class=\"token punctuation\">]</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">=</span><span class=\"token operator\">!</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>n<span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>u<span class=\"token punctuation\">.</span><span class=\"token function\">splice</span><span class=\"token punctuation\">(</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>e<span class=\"token operator\">=</span><span class=\"token function\">f</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>s<span class=\"token operator\">=</span>t<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token keyword\">return</span> e<span class=\"token punctuation\">}</span><span class=\"token keyword\">var</span> n<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>o<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>u<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">function</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">return</span> n<span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">;</span><span class=\"token keyword\">var</span> t<span class=\"token operator\">=</span>n<span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">i</span><span class=\"token operator\">:</span>r<span class=\"token punctuation\">,</span><span class=\"token literal-property property\">l</span><span class=\"token operator\">:</span><span class=\"token operator\">!</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token literal-property property\">exports</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">return</span> e<span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">,</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">.</span>l<span class=\"token operator\">=</span><span class=\"token operator\">!</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">}</span>f<span class=\"token punctuation\">.</span>m<span class=\"token operator\">=</span>e<span class=\"token punctuation\">,</span>f<span class=\"token punctuation\">.</span>c<span class=\"token operator\">=</span>n<span class=\"token punctuation\">,</span>f<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">d</span><span class=\"token operator\">=</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e<span class=\"token punctuation\">,</span>r<span class=\"token punctuation\">,</span>t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>f<span class=\"token punctuation\">.</span><span class=\"token function\">o</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>r<span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperty</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>r<span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">enumerable</span><span class=\"token operator\">:</span><span class=\"token operator\">!</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token literal-property property\">get</span><span class=\"token operator\">:</span>t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>f<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">r</span><span class=\"token operator\">=</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"undefined\"</span><span class=\"token operator\">!==</span><span class=\"token keyword\">typeof</span> Symbol<span class=\"token operator\">&amp;&amp;</span>Symbol<span class=\"token punctuation\">.</span>toStringTag<span class=\"token operator\">&amp;&amp;</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperty</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>Symbol<span class=\"token punctuation\">.</span>toStringTag<span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span><span class=\"token string\">\"Module\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Staattisten tiedostojen tarjoaminen backendistä</h3>\n<p>Eräs mahdollisuus frontendin tuotantoon viemiseen on kopioida tuotantokoodi eli hakemisto <i>dist</i> backendin hakemiston juureen ja määritellä backend näyttämään pääsivunaan frontendin <i>pääsivu</i> eli tiedosto <i>dist/index.html</i>.</p>\n<p>Aloitetaan kopioimalla frontendin tuotantokoodi backendin alle, projektin juureen. Omalla koneellani kopiointi tapahtuu frontendin hakemistosta käsin komennolla</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cp</span> <span class=\"token parameter variable\">-r</span> dist <span class=\"token punctuation\">..</span>/backend</code></pre></div>\n<p>Backendin sisältävän hakemiston tulee nyt näyttää seuraavalta:</p>\n<picture><img src=\"/static/6148bf347bb9674c782d5dfc9bdd643b/5a190/27v.png\" alt=\"ls-komento näyttää tiedostot index.js, Procfile, package.json, package-lock.json sekä hakemistot dist ja node_modules\" srcset=\"/static/6148bf347bb9674c782d5dfc9bdd643b/772e8/27v.png 200w,\n/static/6148bf347bb9674c782d5dfc9bdd643b/e17e5/27v.png 400w,\n/static/6148bf347bb9674c782d5dfc9bdd643b/5a190/27v.png 800w,\n/static/6148bf347bb9674c782d5dfc9bdd643b/f680b/27v.png 1108w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Jotta saamme Expressin näyttämään <i>staattista sisältöä</i> eli sivun <i>index.html</i> ja sen lataaman JavaScriptin ym. tarvitsemme Expressiin sisäänrakennettua middlewarea <a href=\"http://expressjs.com/en/starter/static-files.html\">static</a>.</p>\n<p>Kun lisäämme muiden middlewarejen määrittelyn yhteyteen seuraavan</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">static</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dist'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>tarkastaa Express GET-tyyppisten HTTP-pyyntöjen yhteydessä ensin löytyykö pyynnön polkua vastaavan nimistä tiedostoa hakemistosta <i>dist</i>. Jos löytyy, palauttaa Express tiedoston.</p>\n<p>Nyt HTTP GET ‑pyyntö osoitteeseen <i>www.palvelimenosoite.com/index.html</i> tai <i>www.palvelimenosoite.com</i> näyttää Reactilla tehdyn frontendin. GET-pyynnön esim. osoitteeseen <i>www.palvelimenosoite.com/api/notes</i> hoitaa backendin koodi.</p>\n<p>Koska tässä tapauksessa sekä frontend että backend toimivat samassa osoitteessa, voidaan React-sovelluksessa eli frontendin koodissa oleva palvelimen <em>baseUrl</em> määritellä <a href=\"https://www.w3.org/TR/WD-html40-970917/htmlweb.html#h-5.1.2\">suhteellisena</a> URL:ina eli ilman palvelinta yksilöivää osaa:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> baseUrl <span class=\"token operator\">=</span> <span class=\"token string\">'/api/notes'</span></span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getAll</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> request <span class=\"token operator\">=</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>baseUrl<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p>Muutoksen jälkeen frontendistä on luotava uusi production build ja kopioitava se backendin projektin juureen.</p>\n<p>Sovellusta voidaan käyttää nyt <i>backendin</i> osoitteesta <a href=\"http://localhost:3001\">http://localhost:3001</a>:</p>\n<picture><img src=\"/static/00b60846d754ead099038271e2e54ecc/5a190/28new.png\" alt=\"Mentäessä osoitteeseen localhost:3001 selain renderöi react-sovelluksen, joka listaa muistiinpanot. Jokaisen muistiinpanon yhteydessä on sen tärkeyden muuttava nappi &#x27;make important&#x27; tai &#x27;make not important&#x27;, näkymässä on myös lomake uuden muistiinpanon luomiseen. Tärkeyttä ei lomakkeella tarvitse voida asettaa, ainoastaan muistiinpanon sisältö.\" srcset=\"/static/00b60846d754ead099038271e2e54ecc/772e8/28new.png 200w,\n/static/00b60846d754ead099038271e2e54ecc/e17e5/28new.png 400w,\n/static/00b60846d754ead099038271e2e54ecc/5a190/28new.png 800w,\n/static/00b60846d754ead099038271e2e54ecc/c1b63/28new.png 1200w,\n/static/00b60846d754ead099038271e2e54ecc/29007/28new.png 1600w,\n/static/00b60846d754ead099038271e2e54ecc/ca3c3/28new.png 1850w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Sovelluksemme toiminta vastaa nyt täysin osan 0 luvussa <a href=\"/osa0/web_sovelluksen_toimintaperiaatteita#single-page-app\">Single page app</a> läpikäydyn esimerkkisovelluksen toimintaa.</p>\n<p>Kun mennään selaimella osoitteeseen <a href=\"http://localhost:3001\">http://localhost:3001</a> palauttaa palvelin hakemistossa <i>dist</i> olevan tiedoston <i>index.html</i>, jonka sisältö on seuraava:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">doctype</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>icon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>image/svg+xml<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/vite.svg<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1.0<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Vite + React<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>module<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">crossorigin</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/assets/index-5f6faa37.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/assets/index-198af077.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    \n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Sivu sisältää ohjeen ladata sovelluksen tyylit määrittelevän CSS-tiedoston, sekä kaksi <i>script</i>-tagia, joiden ansiosta selain lataa sovelluksen JavaScript-koodin, eli varsinaisen React-sovelluksen.</p>\n<p>React-koodi hakee palvelimelta muistiinpanot osoitteesta <a href=\"http://localhost:3001/api/notes\">http://localhost:3001/api/notes</a> ja renderöi ne ruudulle. Selaimen ja palvelimen kommunikaatio selviää tuttuun tapaan konsolin välilehdeltä <i>Network</i>:</p>\n<picture><img src=\"/static/7e90543c1d9697b1058225a877364cb9/5a190/29new.png\" alt=\"Välilehti Network kertoo että on tehty pyyntö GET localhost:3001/api/notes\" srcset=\"/static/7e90543c1d9697b1058225a877364cb9/772e8/29new.png 200w,\n/static/7e90543c1d9697b1058225a877364cb9/e17e5/29new.png 400w,\n/static/7e90543c1d9697b1058225a877364cb9/5a190/29new.png 800w,\n/static/7e90543c1d9697b1058225a877364cb9/c1b63/29new.png 1200w,\n/static/7e90543c1d9697b1058225a877364cb9/29007/29new.png 1600w,\n/static/7e90543c1d9697b1058225a877364cb9/9e7e4/29new.png 2056w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Tuotantoa varten tehty suoritusympäristö näyttää siis seuraavalta:</p>\n<picture><img src=\"/static/ee40b09299b5cbf969989a2ad320d198/db910/101.png\" alt=\"Selain hakee json-muotoisen datan localhost:3001/api/notes reitiltä ja suoritettavan react-sovelluksen js-koodin sekä index.html-tiedoston osoitteesta localhost:3001. Backend hakee tarvitsemansa js-tiedostot ja index.html:n paikalliselta levyltä.\" srcset=\"/static/ee40b09299b5cbf969989a2ad320d198/772e8/101.png 200w,\n/static/ee40b09299b5cbf969989a2ad320d198/db910/101.png 396w\" sizes=\"(max-width: 396px) 100vw, 396px\"></picture>\n<p>Toisin kuin sovelluskehitysympäristössä, kaikki sovelluksen tarvitsema löytyy nyt node/express-palvelimelta osoitteesta localhost:3001. Kun osoitteeseen mennään, renderöi selain pääsivun <i>index.html</i> mikä taas aiheuttaa sen, että React-sovelluksen tuotantoversio haetaan palvelimelta ja selain alkaa suorittamaan sitä. Tämä taas saa aikaan sen, että ruudulla näytettävä JSON-muotoinen data haetaan osoitteesta localhost:3001/api/notes.</p>\n<h3>Koko sovellus Internetiin</h3>\n<p>Kun sovelluksen \"Internetiin vietävä\" tuotantoversio todetaan toimivaksi paikallisesti, voidaan koko sovellus siirtää suoritettavaksi valittuun palveluun.</p>\n<p><strong>Fly.io:n tapauksessa</strong> sovelluksen uusi versio käynnistyy komennolla</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">fly deploy</code></pre></div>\n<p><strong>HUOM:</strong> Projektin juureen luotu <em>.dockerignore</em>-tiedosto listaa ne tiedostot, joita ei oteta mukaan deploymentiin, ja dist-kansio saattaa olla siellä mukana oletuksena. Jos näin on, poista viittaus dist/ <em>.dockerignore</em>-tiedostosta, jotta sovelluksesi otetaan käyttöön oikein.</p>\n<p><strong>Renderin tapauksessa</strong> commitoidaan tehdyt muutokset ja pushataan koodi GitHubiin. Automaattinen uudelleenkäynnistys saattaa toimia, mutta jos näin ei ole, käynnistä uusi versio itse dashboardin kautta tekemällä \"manual deployment\".</p>\n<p>Sovellus toimii moitteettomasti lukuun ottamatta vielä backendiin toteuttamatonta muistiinpanon tärkeyden muuttamista:</p>\n<picture><img src=\"/static/7003b3eacf4ce56213d8be4bea2df167/5a190/30new.png\" alt=\"Selain renderöi sovelluksen frontendin (joka näyttää palvelimella olevan datan) mentäessä sovelluksen urlin juureen\" srcset=\"/static/7003b3eacf4ce56213d8be4bea2df167/772e8/30new.png 200w,\n/static/7003b3eacf4ce56213d8be4bea2df167/e17e5/30new.png 400w,\n/static/7003b3eacf4ce56213d8be4bea2df167/5a190/30new.png 800w,\n/static/7003b3eacf4ce56213d8be4bea2df167/c1b63/30new.png 1200w,\n/static/7003b3eacf4ce56213d8be4bea2df167/29007/30new.png 1600w,\n/static/7003b3eacf4ce56213d8be4bea2df167/8454b/30new.png 1798w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Sovelluksemme tallettama tieto ei ole ikuisesti pysyvää, sillä sovellus tallettaa muistiinpanot muuttujaan. Jos sovellus kaatuu tai se uudelleenkäynnistetään, kaikki tiedot katoavat.</p>\n<p>Tarvitsemme sovelluksellemme tietokannan. Ennen tietokannan käyttöönottoa katsotaan kuitenkin vielä muutamaa asiaa.</p>\n<p>Tuotannossa oleva sovellus näyttää seuraavalta:</p>\n<picture><img src=\"/static/cb4cbf3b34d7096b0de655cc6e114e18/5a190/102.png\" alt=\"Selain hakee json-muotoisen datan nameoftheapp.herokuapp.com/api/notes osoitteesta ja suoritettavan react-sovelluksen js-koodin sekä index.html-tiedoston osoitteesta  nameoftheapp.herokuapp.com. Backend hakee tarvitsemansa js-tiedostot ja index.html:n herokun palvelimen levyltä.\" srcset=\"/static/cb4cbf3b34d7096b0de655cc6e114e18/772e8/102.png 200w,\n/static/cb4cbf3b34d7096b0de655cc6e114e18/e17e5/102.png 400w,\n/static/cb4cbf3b34d7096b0de655cc6e114e18/5a190/102.png 800w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Nyt siis node/express-backend sijaitsee Fly.io:n/Renderin palvelimella. Kun selaimella mennään sovelluksen \"juuriosoitteeseen\", alkaa selain suorittamaan React-koodia, joka taas hakee JSON-muotoisen datan Fly.io:sta/Renderistä.</p>\n<h3>Frontendin deployauksen suoraviivaistus</h3>\n<p>Jotta uuden frontendin version generointi onnistuisi jatkossa ilman turhia manuaalisia askelia, lisätään uusia skriptejä backendin <i>package.json</i>-tiedostoon.</p>\n<h4>Fly.io</h4>\n<p>Fly.io:n tapauksessa skriptit näyttävät seuraavalta:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token property\">\"build:ui\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rm -rf dist &amp;&amp; cd ../frontend/ &amp;&amp; npm run build &amp;&amp; cp -r dist ../backend\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"deploy\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fly deploy\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"deploy:full\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm run build:ui &amp;&amp; npm run deploy\"</span><span class=\"token punctuation\">,</span>    \n    <span class=\"token property\">\"logs:prod\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fly logs\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Skripteistä <em>npm run build:ui</em> kääntää ui:n tuotantoversioksi ja kopioi sen. <em>npm run deploy</em> julkaisee Fly.io:n.</p>\n<p><em>npm run deploy:full</em> yhdistää molemmat edellä mainitut komennot. Lisätään lisäksi oma skripti <em>npm run logs:prod</em> lokien lukemiseen, jolloin käytännössä kaikki toimii npm-skriptein.</p>\n<p>Huomaa, että skriptissä <i>build:ui</i> olevat polut riippuvat frontendin ja backendin hakemistojen sijainnista.</p>\n<h5>Huomautus Windows-käyttäjille</h5>\n<p>Huomaa, että näistä <em>build:ui</em>:n käyttämät shell-komennot eivät toimi natiivisti Windowsilla, jonka powershell käyttää eri komentoja. Tällöin skripti olisi</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"build:ui\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@powershell Remove-Item -Recurse -Force dist &amp;&amp; cd ../frontend &amp;&amp; npm run build &amp;&amp; @powershell Copy-Item dist -Recurse ../backend\"</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Mikäli skripti ei toimi Windowsilla, tarkista, että terminaalisi sovelluskehitysympäristössäsi on Powershell eikä esimerkiksi Command Prompt. Jos olet asentanut Git Bash ‑terminaalin, tai muun Linuxia matkivan terminaalin tai ympäristön, saatat pystyä ajamaan Linuxin kaltaisia komentoja myös Windowsilla.</p>\n<h4>Render</h4>\n<p>Renderin tapauksessa skriptit näyttävät seuraavalta:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token property\">\"build:ui\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rm -rf dist &amp;&amp; cd ../frontend &amp;&amp; npm run build &amp;&amp; cp -r dist ../backend\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"deploy:full\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm run build:ui &amp;&amp; git add . &amp;&amp; git commit -m uibuild &amp;&amp; git push\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Skripteistä <em>npm run build:ui</em> kääntää ui:n tuotantoversioksi ja kopioi sen.</p>\n<p><em>npm run deploy:full</em> sisältää edellisen lisäksi vaadittavat <i>git</i>-komennot versionhallinnan päivittämistä varten.</p>\n<p>Huomaa, että skriptissä <i>build:ui</i> olevat polut riippuvat frontendin ja backendin hakemistojen sijainnista.</p>\n<h3>Proxy</h3>\n<p>Frontendiin tehtyjen muutosten seurauksena on nyt se, että kun suoritamme frontendiä sovelluskehitysmoodissa eli käynnistämällä sen komennolla <em>npm run dev</em>, yhteys backendiin ei toimi:</p>\n<picture><img src=\"/static/c2dc22eab2be6e45278c02055c079123/5a190/32new.png\" alt=\"Network-tabi kertoo että pyyntöön localhost:3000/api/notes vastataan statuskoodilla 404\" srcset=\"/static/c2dc22eab2be6e45278c02055c079123/772e8/32new.png 200w,\n/static/c2dc22eab2be6e45278c02055c079123/e17e5/32new.png 400w,\n/static/c2dc22eab2be6e45278c02055c079123/5a190/32new.png 800w,\n/static/c2dc22eab2be6e45278c02055c079123/c1b63/32new.png 1200w,\n/static/c2dc22eab2be6e45278c02055c079123/29007/32new.png 1600w,\n/static/c2dc22eab2be6e45278c02055c079123/17d12/32new.png 1666w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Syynä tälle on se, että backendin osoite muutettiin suhteellisesti määritellyksi:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> baseUrl <span class=\"token operator\">=</span> <span class=\"token string\">'/api/notes'</span></code></pre></div>\n<p>Koska frontend toimii osoitteessa <i>localhost:5173</i>, menevät backendiin tehtävät pyynnöt väärään osoitteeseen <i>localhost:5173/api/notes</i>. Backend toimii kuitenkin osoitteessa <i>localhost:3001</i>.</p>\n<p>Vitellä luoduissa projekteissa ongelma on helppo ratkaista. Riittää, että frontendin tiedostoon <i>vite.config.js</i> lisätään seuraava määritelmä:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> defineConfig <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'vite'</span>\n<span class=\"token keyword\">import</span> react <span class=\"token keyword\">from</span> <span class=\"token string\">'@vitejs/plugin-react'</span>\n\n<span class=\"token comment\">// https://vitejs.dev/config/</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">defineConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token function\">react</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token literal-property property\">server</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token literal-property property\">proxy</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token string-property property\">'/api'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token literal-property property\">target</span><span class=\"token operator\">:</span> <span class=\"token string\">'http://localhost:3001'</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token literal-property property\">changeOrigin</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Uudelleenkäynnistyksen jälkeen Reactin sovelluskehitysympäristö toimii välityspalvelimena eli <a href=\"https://vitejs.dev/config/server-options.html#server-proxy\">proxynä</a>. Jos React-koodi tekee HTTP-pyynnön <i><a href=\"http://localhost:5173/api\">http://localhost:5173/api</a></i>-alkuiseen polkuun, lähetetään pyyntö edelleen osoitteessa <i><a href=\"http://localhost:3001\">http://localhost:3001</a></i> olevalle palvelimelle. Muihin polkuihin tulevat pyynnöt kehityspalvelin käsittelee normaalisti.</p>\n<p>Nyt myös frontend on kunnossa. Se toimii sekä sovelluskehitysmoodissa että tuotannossa yhdessä palvelimen kanssa. Koska frontendin näkökulmasta kaikki pyynnöt suuntautuvat osoitteeseen <a href=\"http://localhost:5173\">http://localhost:5173</a> eli yhteen ja samaan originiin, ei tarvetta backendin cors-middlewarelle enää ole. Poistetaan siis viittaukset cors-kirjastoon backendin <i>index.js</i>-tiedostosta, ja poistetaan <i>cors</i> projektin riippuvuuksista:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> remove cors</code></pre></div>\n<p>Olemme nyt vieneet koko sovelluksen onnistuneesti internetiin. Deploymenttien toteuttamiseen on olemassa monenlaisia muitakin tapoja. Esimerkiksi frontendin koodin deployaaminen omana sovelluksenaan voi joissain tilanteissa olla järkevää, sillä se voi helpottaa automatisoidun <a href=\"https://martinfowler.com/bliki/DeploymentPipeline.html\">deployment pipelinen</a> toteuttamista. Deployment pipelinellä tarkoitetaan automatisoitua ja hallittua tapaa viedä koodi sovelluskehittäjän koneelta erilaisten testien ja laadunhallinnallisten vaiheiden kautta tuotantoympäristöön. Aiheeseen tutustutaan kurssin <a href=\"/osa11\">osassa 11</a>.</p>\n<p>Sovelluksen tämänhetkinen koodi on kokonaisuudessaan <a href=\"https://github.com/fullstack-hy2020/part3-notes-backend/tree/part3-3\">GitHubissa</a>, branchissa <i>part3-3</i>.</p>\n<p>Frontendin koodiin tehdyt muutokset ovat <a href=\"https://github.com/fullstack-hy2020/part2-notes-frontend/tree/part3-1\">frontendin repositorion</a> branchissa <i>part3-1</i>.</p>\n</div>\n<div class=\"tasks\">\n<h3>Tehtävät 3.9.-3.11.</h3>\n<p>Seuraavissa tehtävissä koodia ei tarvita montaa riviä. Tehtävät ovat kuitenkin haastavia, sillä nyt on tarkalleen hallittava, missä tapahtuu mitäkin, ja kaikki konfiguraatiot on tehtävä täsmälleen oikein. </p>\n<h4>3.9 puhelinluettelon backend step9</h4>\n<p>Laita backend toimimaan edellisessä osassa tehdyn puhelinluettelon frontendin kanssa muilta osin paitsi mahdollisen puhelinnumeron muutoksen osalta, jonka vastaava toiminnallisuus toteutetaan backendiin vasta tehtävässä 3.17.</p>\n<p>Joudut todennäköisesti tekemään frontendiin erinäisiä pieniä muutoksia ainakin backendin oletettujen urlien osalta. Muista pitää selaimen konsoli koko ajan auki. Jos jotkut HTTP-pyynnöt epäonnistuvat, kannattaa katsoa <i>Network</i>-välilehdeltä, mitä tapahtuu. Pidä myös silmällä, mitä palvelimen konsolissa tapahtuu. Jos et tehnyt edellistä tehtävää, kannattaa POST-pyyntöä käsittelevässä tapahtumankäsittelijässä tulostaa konsoliin mukana tuleva data eli <i>request.body</i>.</p>\n<h4>3.10 puhelinluettelon backend step10</h4>\n<p>Vie sovelluksen backend Internetiin, esim. Fly.io:n tai Renderiin. Jos käytät Fly.io:ta, komennot tulee suorittaa backendin juurihakemistossa (eli samassa kansiossa, jossa backendin <i>package.json</i>-tiedosto sijaitsee).</p>\n<p><strong>PRO TIP:</strong> kun deployaat sovelluksen Fly.io:n tai Renderiin, kannattaa ainakin alkuvaiheissa pitää <strong>KOKO AJAN</strong> näkyvillä sovelluksen loki.</p>\n<p>Testaa selaimen ja Postmanin tai VS Coden REST-clientin avulla, että Internetissä oleva backend toimii.</p>\n<p>Tee repositorion juureen tiedosto README.md ja lisää siihen linkki Internetissä olevaan sovellukseesi.</p>\n<h4>3.11 puhelinluettelo full stack</h4>\n<p>Generoi frontendistä tuotantoversio ja lisää se Internetissä olevaan sovellukseesi tässä osassa esiteltyä menetelmää noudattaen.</p>\n<p>Huolehdi myös, että frontend toimii edelleen myös paikallisesti.</p>\n<p>Jos käytät Renderiä, varmista, että hakemisto <i>dist</i> ole gitignoroituna projektissasi.</p>\n<p><strong>HUOM:</strong> Frontendiä ei julkaista suoraan missään vaiheessa tämän osan aikana. Vain backend-repositorio viedään Internetiin. Frontendin tuotantoversio lisätään backend-repositorioon, ja backend näyttää sen pääsivunaan kuten kohdassa <a href=\"/osa3/sovellus_internetiin#staattisten-tiedostojen-tarjoaminen-backendista\">Staattisten tiedostojen tarjoaminen backendistä</a> on kuvattu.</p>\n</div>","frontmatter":{"mainImage":{"publicURL":"/static/8ac7bc0fb2b7018a7853b00c454b2103/part-3.svg"},"part":3,"letter":"b","lang":"fi"}}},"pageContext":{"part":3,"letter":"b","lang":"fi"}},"staticQueryHashes":["3128451518"]}